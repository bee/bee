#!/bin/bash

BEE_VERSION="@BEE_VERSION@"

: ${BEE_SYSCONFDIR:=@SYSCONFDIR@}
: ${BEE_DEFCONFDIR:=@DEFCONFDIR@}
: ${BEE_DATADIR:=@DATADIR@}
: ${BEE_LIBDIR:=@LIBDIR@}
: ${BEE_LIBEXECDIR:=@LIBEXECDIR@}

# load libs
. ${BEE_LIBEXECDIR}/bee/beelib.config.sh

function print_msg() {
    echo >&2 -e "${COLOR_BRACKET}[${COLOR_BRCONTENT}BEE${COLOR_BRACKET}] ${@}"
}

function print_info() {
    print_msg "${COLOR_INFO}${@}${COLOR_NORMAL}"
}

function print_error() {
    print_msg "${COLOR_ERROR}${@}${COLOR_NORMAL}"
}

function usage() {
    echo "usage: $0 <option> <arguments>"
    echo "possible options are:"
    echo "  init"
    echo "  install"
    echo "  remove"
    echo "  check"
}

function search_tool_cmd {
    local IFS=":${IFS}"
    local tool=${1}

    if [ -z "${tool}" ] ; then
        return
    fi

    CMD=

    for dir in ${XDG_CONFIG_HOME} ${XDG_CONFIG_DIRS} ${BEE_LIBEXECDIR} ; do
        cmd="${dir}/bee/bee.d/bee-${tool}"
        if [ -x "${cmd}" ] ; then
            CMD=${cmd}
            return
        fi
    done
}

TOOL=${1}

config_init

config_export

search_tool_cmd ${TOOL}

if [ ! -z  "${CMD}" ] ; then
    shift
    exec ${CMD} ${@}
    exit 1
fi

usage
exit 1
